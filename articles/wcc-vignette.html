<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to intCC • intCC</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to intCC">
<meta property="og:description" content="intCC">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">intCC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/wcc-vignette.html">Introduction to intCC</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to intCC</h1>
                        <h4 data-toc-skip class="author">Can Huang</h4>
            
            <h4 data-toc-skip class="date">2023-07-23</h4>
      
      
      <div class="hidden name"><code>wcc-vignette.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>To install and load intCC</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"candsj/intCC"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"intCC"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Analysis of omic datasets has become more and more important
recently. It could help to define cancer subtypes and reveal novel
discoveries. How to integrate omic datasets raised much-growing
attention. The Cancer Genome Atlas Program began in 2006 and generated
over 2.5 petabytes of genomic, epigenomic, transcriptomic, and proteomic
data. This greatly improved the development of omic datasets research.
Various integrative clustering methods and tools have been proposed. We
proposed two-layer intCC method to deal with some limitations
existed.</p>
</div>
<div class="section level2">
<h2 id="usage-of-intcc">Usage of intCC<a class="anchor" aria-label="anchor" href="#usage-of-intcc"></a>
</h2>
<p>The R package <strong>intCC</strong> (<strong>i</strong>ntegrative
<strong>C</strong>onsensus <strong>C</strong>lustering) introduces intCC
functions inspired by consensus clustering methods.</p>
<p>The main function in this package is <code>intCC</code>. Users input
a list of datasets, clusteing methods, the number of clutsers for
separate datasets and global, criterions and so on. Then consensus
clustering will be applied to each dataset to derive consensus matrix.
Depends on 1 layer or 2 layer, consensus matrix will be weighted and
combined for each dataset and final clustering. Finally user could
choose pam or hierarchical clustering method to derive the clustering
results. Some useful functions are also included in this package:</p>
<ul>
<li><p><code>criterion</code>. This function takes a list of consensus
matrix, a list of corresponding clustering label results and a vector of
corresponding number of clusters. It could use Silhouette, widestGap,
dunns and dunn2s index as criterion to choose the best number of
clusters.</p></li>
<li><p><code>weightcal</code>. This function takes a list of consensus
matrix and clustering label results. Then weights are calculated based
on ratio of in-cluster proportion to out-of-cluster proportion using the
cluster estimated by the algorithm itself. It could help to estimate
weights for different methods of each methods or weights for consensus
matrix of each dataset.</p></li>
<li><p><code>plot_CM</code>. This function takes a list of consensus
matrix and clustering label results and dataset if provided. Then
heatmap could be generated for consensus matrix and dataset if
provided.</p></li>
</ul>
<p>The other function needed for this is <code>consensusCluster</code>.
This function can be found in the R package <code>coca</code> and is
used to perform consensus clustering on one dataset and obtain a
co-clustering matrix (Monti et al. 2003). We made some changes to this
function to allow users to define more distance metric and sample
percentage for features.</p>
</div>
<div class="section level2">
<h2 id="how-intcc-works">How intCC works<a class="anchor" aria-label="anchor" href="#how-intcc-works"></a>
</h2>
<p>First, we generate four different type datasets with the same
clustering structure (3 clusters of equal size) and different levels of
noise.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"exampleData.RData"</span>, package <span class="op">=</span> <span class="st">"intCC"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">normData</span><span class="op">=</span><span class="va">exampleData</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">binomData</span><span class="op">=</span><span class="va">exampleData</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">poisData</span><span class="op">=</span><span class="va">exampleData</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">multData</span><span class="op">=</span><span class="va">exampleData</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">lopoisData</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">poisData</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Now we can use the <code>consensusclustering</code> function to
compute a consensus matrix for each dataset.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">normRes</span><span class="op">=</span><span class="fu"><a href="../reference/consensuscluster.html">consensuscluster</a></span><span class="op">(</span><span class="va">normData</span>,K<span class="op">=</span><span class="fl">3</span>,B<span class="op">=</span><span class="fl">1000</span>,pItem <span class="op">=</span> <span class="fl">0.8</span>,pFeature <span class="op">=</span> <span class="fl">0.8</span> ,clMethod <span class="op">=</span><span class="st">"kmeans"</span>,finalclmethod<span class="op">=</span><span class="st">"pam"</span><span class="op">)</span></span>
<span>  <span class="va">binomRes</span><span class="op">=</span><span class="fu"><a href="../reference/consensuscluster.html">consensuscluster</a></span><span class="op">(</span><span class="va">binomData</span>,K<span class="op">=</span><span class="fl">3</span>,B<span class="op">=</span><span class="fl">1000</span>,pItem <span class="op">=</span> <span class="fl">0.8</span>,pFeature <span class="op">=</span> <span class="fl">0.8</span> ,clMethod <span class="op">=</span><span class="st">"kmeans"</span>,finalclmethod<span class="op">=</span><span class="st">"pam"</span><span class="op">)</span></span>
<span>  <span class="va">poisRes</span><span class="op">=</span><span class="fu"><a href="../reference/consensuscluster.html">consensuscluster</a></span><span class="op">(</span><span class="va">lopoisData</span>,K<span class="op">=</span><span class="fl">3</span>,B<span class="op">=</span><span class="fl">1000</span>,pItem <span class="op">=</span> <span class="fl">0.8</span>,pFeature <span class="op">=</span> <span class="fl">0.8</span> ,clMethod <span class="op">=</span><span class="st">"kmeans"</span>,finalclmethod<span class="op">=</span><span class="st">"pam"</span><span class="op">)</span></span>
<span>  <span class="va">multRes</span><span class="op">=</span><span class="fu"><a href="../reference/consensuscluster.html">consensuscluster</a></span><span class="op">(</span><span class="va">multData</span>,K<span class="op">=</span><span class="fl">3</span>,B<span class="op">=</span><span class="fl">1000</span>,pItem <span class="op">=</span> <span class="fl">0.8</span>,pFeature <span class="op">=</span> <span class="fl">0.8</span> ,clMethod <span class="op">=</span><span class="st">"kmeans"</span>,finalclmethod<span class="op">=</span><span class="st">"pam"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">normRes1</span><span class="op">=</span><span class="fu"><a href="../reference/consensuscluster.html">consensuscluster</a></span><span class="op">(</span><span class="va">normData</span>,K<span class="op">=</span><span class="fl">3</span>,B<span class="op">=</span><span class="fl">1000</span>,pItem <span class="op">=</span> <span class="fl">0.8</span>,pFeature <span class="op">=</span> <span class="fl">0.8</span> ,clMethod <span class="op">=</span><span class="st">"hclust"</span>,finalclmethod<span class="op">=</span><span class="st">"pam"</span><span class="op">)</span></span>
<span>  <span class="va">binomRes1</span><span class="op">=</span><span class="fu"><a href="../reference/consensuscluster.html">consensuscluster</a></span><span class="op">(</span><span class="va">binomData</span>,K<span class="op">=</span><span class="fl">3</span>,B<span class="op">=</span><span class="fl">1000</span>,pItem <span class="op">=</span> <span class="fl">0.8</span>,pFeature <span class="op">=</span> <span class="fl">0.8</span> ,clMethod <span class="op">=</span><span class="st">"hclust"</span>,dist <span class="op">=</span> <span class="st">"binary"</span>,finalclmethod<span class="op">=</span><span class="st">"pam"</span><span class="op">)</span></span>
<span>  <span class="va">poisRes1</span><span class="op">=</span><span class="fu"><a href="../reference/consensuscluster.html">consensuscluster</a></span><span class="op">(</span><span class="va">poisData</span>,K<span class="op">=</span><span class="fl">3</span>,B<span class="op">=</span><span class="fl">1000</span>,pItem <span class="op">=</span> <span class="fl">0.8</span>,pFeature <span class="op">=</span> <span class="fl">0.8</span> ,clMethod <span class="op">=</span><span class="st">"hclust"</span>,dist <span class="op">=</span> <span class="st">"jaccard"</span>,finalclmethod<span class="op">=</span><span class="st">"pam"</span><span class="op">)</span></span>
<span>  <span class="va">multRes1</span><span class="op">=</span><span class="fu"><a href="../reference/consensuscluster.html">consensuscluster</a></span><span class="op">(</span><span class="va">multData</span>,K<span class="op">=</span><span class="fl">3</span>,B<span class="op">=</span><span class="fl">1000</span>,pItem <span class="op">=</span> <span class="fl">0.8</span>,pFeature <span class="op">=</span> <span class="fl">0.8</span> ,clMethod <span class="op">=</span><span class="st">"hclust"</span>,dist <span class="op">=</span> <span class="st">"hamming"</span>,finalclmethod<span class="op">=</span><span class="st">"pam"</span><span class="op">)</span></span></code></pre></div>
<p>Then we could perform 1 layer intCC.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">res_1layer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">normRes</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">binomRes</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">poisRes</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">multRes</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">weights</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/weightcal.html">weightcal</a></span><span class="op">(</span><span class="va">res.1layer</span><span class="op">)</span></span>
<span>  <span class="va">wcm</span><span class="op">=</span><span class="va">weights</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">res.1layer</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span><span class="op">+</span><span class="va">weights</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">res.1layer</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span><span class="op">+</span></span>
<span>    <span class="va">weights</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">*</span><span class="va">res.1layer</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span><span class="op">+</span><span class="va">weights</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">*</span><span class="va">res.1layer</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span></span>
<span>  <span class="va">distances</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">wcm</span><span class="op">)</span></span>
<span>  <span class="va">weight_clusterLabels</span> <span class="op">&lt;-</span> <span class="fu">pam</span><span class="op">(</span><span class="va">distances</span>,<span class="fl">3</span>,diss <span class="op">=</span> <span class="cn">TRUE</span>,metric <span class="op">=</span> <span class="st">"euclidean"</span> <span class="op">)</span><span class="op">$</span><span class="va">clustering</span></span>
<span>  <span class="va">ari.weight</span><span class="op">&lt;-</span> <span class="fu">adjustedRandIndex</span><span class="op">(</span><span class="va">true.class</span>, <span class="va">weight_clusterLabels</span><span class="op">)</span></span></code></pre></div>
<p>Or we could perform 2 layer intCC.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co">#norm</span></span>
<span>  <span class="va">res.norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">normRes</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">normRes1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">weight.norm</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/weightcal.html">weightcal</a></span><span class="op">(</span><span class="va">res.norm</span><span class="op">)</span></span>
<span>  <span class="va">wcm</span><span class="op">=</span><span class="va">weight.norm</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">res.norm</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span><span class="op">+</span><span class="va">weight.norm</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">res.norm</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span></span>
<span>  <span class="va">distances</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">wcm</span><span class="op">)</span></span>
<span>  <span class="va">weight_clusterLabels</span> <span class="op">&lt;-</span><span class="fu">pam</span><span class="op">(</span><span class="va">distances</span>,<span class="fl">3</span>,diss <span class="op">=</span> <span class="cn">TRUE</span>,metric <span class="op">=</span> <span class="st">"euclidean"</span> <span class="op">)</span><span class="op">$</span><span class="va">clustering</span></span>
<span>  <span class="va">weightnormRes</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>consensusMatrix<span class="op">=</span><span class="va">wcm</span>,class<span class="op">=</span><span class="va">weight_clusterLabels</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">#binom</span></span>
<span>  <span class="va">res.binom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">binomRes</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">binomRes1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">weight.binom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/weightcal.html">weightcal</a></span><span class="op">(</span><span class="va">res.binom</span><span class="op">)</span></span>
<span>  <span class="va">wcm</span><span class="op">=</span><span class="va">weight.binom</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">res.binom</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span><span class="op">+</span><span class="va">weight.binom</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">res.binom</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span></span>
<span>  <span class="va">distances</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">wcm</span><span class="op">)</span></span>
<span>  <span class="va">weight_clusterLabels</span> <span class="op">&lt;-</span> <span class="fu">pam</span><span class="op">(</span><span class="va">distances</span>,<span class="fl">3</span>,diss <span class="op">=</span> <span class="cn">TRUE</span>,metric <span class="op">=</span> <span class="st">"euclidean"</span> <span class="op">)</span><span class="op">$</span><span class="va">clustering</span></span>
<span>  <span class="va">weightbinomRes</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>consensusMatrix<span class="op">=</span><span class="va">wcm</span>,class<span class="op">=</span><span class="va">weight_clusterLabels</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">#poisson</span></span>
<span>  <span class="va">res.pois</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">poisRes</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">poisRes1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">weight.pois</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/weightcal.html">weightcal</a></span><span class="op">(</span><span class="va">res.pois</span><span class="op">)</span></span>
<span>  <span class="va">wcm</span><span class="op">=</span><span class="va">weight.pois</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">res.pois</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span><span class="op">+</span><span class="va">weight.pois</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">res.pois</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span></span>
<span>  <span class="va">distances</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">wcm</span><span class="op">)</span></span>
<span>  <span class="va">weight_clusterLabels</span> <span class="op">&lt;-</span><span class="fu">pam</span><span class="op">(</span><span class="va">distances</span>,<span class="fl">3</span>,diss <span class="op">=</span> <span class="cn">TRUE</span>,metric <span class="op">=</span> <span class="st">"euclidean"</span> <span class="op">)</span><span class="op">$</span><span class="va">clustering</span></span>
<span>  <span class="va">weightpoisRes</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>consensusMatrix<span class="op">=</span><span class="va">wcm</span>,class<span class="op">=</span><span class="va">weight_clusterLabels</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">#mult</span></span>
<span>  <span class="va">res.mult</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">multRes</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">multRes1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">weight.mult</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/weightcal.html">weightcal</a></span><span class="op">(</span><span class="va">res.mult</span><span class="op">)</span></span>
<span>  <span class="va">wcm</span><span class="op">=</span><span class="va">weight.mult</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">res.mult</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span><span class="op">+</span><span class="va">weight.mult</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">res.mult</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span></span>
<span>  <span class="va">distances</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">wcm</span><span class="op">)</span></span>
<span>  <span class="va">weight_clusterLabels</span> <span class="op">&lt;-</span> <span class="fu">pam</span><span class="op">(</span><span class="va">distances</span>,<span class="fl">3</span>,diss <span class="op">=</span> <span class="cn">TRUE</span>,metric <span class="op">=</span> <span class="st">"euclidean"</span> <span class="op">)</span><span class="op">$</span><span class="va">clustering</span></span>
<span>  <span class="va">weightmultRes</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>consensusMatrix<span class="op">=</span><span class="va">wcm</span>,class<span class="op">=</span><span class="va">weight_clusterLabels</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">#2 layer wcm</span></span>
<span>  <span class="va">res.2layer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">weightnormRes</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">weightbinomRes</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">weightpoisRes</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">weightmultRes</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">weight.wcm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/weightcal.html">weightcal</a></span><span class="op">(</span><span class="va">res.2layer</span><span class="op">)</span></span>
<span>  <span class="va">wcm</span><span class="op">=</span><span class="va">weight.wcm</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">res.2layer</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span><span class="op">+</span><span class="va">weight.wcm</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">res.2layer</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span><span class="op">+</span></span>
<span>    <span class="va">weight.wcm</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">*</span><span class="va">res.2layer</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span><span class="op">+</span><span class="va">weight.wcm</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">*</span><span class="va">res.2layer</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span></span>
<span>  <span class="va">distances</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">wcm</span><span class="op">)</span></span>
<span>  <span class="va">weight_clusterLabels</span> <span class="op">&lt;-</span> <span class="fu">pam</span><span class="op">(</span><span class="va">distances</span>,<span class="fl">3</span>,diss <span class="op">=</span> <span class="cn">TRUE</span>,metric <span class="op">=</span> <span class="st">"euclidean"</span> <span class="op">)</span><span class="op">$</span><span class="va">clustering</span></span>
<span>  <span class="va">end.time3</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">ari.wcm</span> <span class="op">&lt;-</span> <span class="fu">adjustedRandIndex</span><span class="op">(</span><span class="va">true.class</span>, <span class="va">weight_clusterLabels</span><span class="op">)</span></span></code></pre></div>
<p>The same can be done simply using the function <code>intCC</code></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#1 layer</span></span>
<span>  <span class="va">res.1layer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/intCC.html">intCC</a></span><span class="op">(</span><span class="va">exampleData</span>, method<span class="op">=</span><span class="st">"1 layer"</span>, individualK <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>                                   globalK <span class="op">=</span> <span class="fl">3</span>, pFeature <span class="op">=</span> <span class="fl">0.8</span> ,ccClMethods <span class="op">=</span> <span class="st">"kmeans"</span>,</span>
<span>                                    ccDistHCs <span class="op">=</span> <span class="st">"euclidean"</span>,hclustMethod <span class="op">=</span> <span class="st">"average"</span>,finalclmethod<span class="op">=</span><span class="st">"hclust"</span>,</span>
<span>                                    finalhclustMethod <span class="op">=</span> <span class="st">"average"</span>,Silhouette<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#2 layer</span></span>
<span>  <span class="va">data_for_intCC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">data_for_intCC</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="va">normData</span></span>
<span>  <span class="va">data_for_intCC</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="va">binomData</span></span>
<span>  <span class="va">data_for_intCC</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="va">lopoisData</span></span>
<span>  <span class="va">data_for_intCC</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="va">multData</span></span>
<span>  <span class="va">data_for_intCC</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="va">normData</span></span>
<span>  <span class="va">data_for_intCC</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="va">binomData</span></span>
<span>  <span class="va">data_for_intCC</span><span class="op">[[</span><span class="fl">7</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="va">poisData</span></span>
<span>  <span class="va">data_for_intCC</span><span class="op">[[</span><span class="fl">8</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="va">multData</span></span>
<span>  <span class="va">res.2layer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/intCC.html">intCC</a></span><span class="op">(</span><span class="va">data_for_intCC</span>, method<span class="op">=</span><span class="st">"2 layer"</span>, individualK <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>                     globalK <span class="op">=</span> <span class="fl">3</span>, pFeature <span class="op">=</span> <span class="fl">0.8</span> ,ccClMethods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"kmeans"</span>,<span class="st">"kmeans"</span>,<span class="st">"kmeans"</span>,<span class="st">"kmeans"</span>,</span>
<span>                                                                  <span class="st">"hclust"</span>,<span class="st">"hclust"</span>,<span class="st">"hclust"</span>,<span class="st">"hclust"</span><span class="op">)</span>,</span>
<span>                     ccDistHCs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"euclidean"</span>,<span class="st">"euclidean"</span>,<span class="st">"euclidean"</span>,<span class="st">"euclidean"</span>,</span>
<span>                                   <span class="st">"euclidean"</span>,<span class="st">"binary"</span>,<span class="st">"jaccard"</span>,<span class="st">"hamming"</span><span class="op">)</span>,hclustMethod <span class="op">=</span> <span class="st">"average"</span>,finalclmethod<span class="op">=</span><span class="st">"hclust"</span>,finalhclustMethod <span class="op">=</span> <span class="st">"average"</span>,Silhouette<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Heatmap could be generated by <code>plot_CM</code> function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Heatmap for consensus matrix</span></span>
<span><span class="fu"><a href="../reference/plot_CM.html">plot_CM</a></span><span class="op">(</span>result<span class="op">=</span><span class="va">normRes</span><span class="op">)</span></span>
<span><span class="co">#Heatmap for consensus matrix and dataset if dataset provided</span></span>
<span><span class="fu"><a href="../reference/plot_CM.html">plot_CM</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">normData</span>,result<span class="op">=</span><span class="va">normRes</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.3.1 (2023-06-16)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.2 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices datasets  utils     methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] vctrs_0.6.3       cli_3.6.1         knitr_1.43        rlang_1.1.1      </span></span>
<span><span class="co">##  [5] xfun_0.39         stringi_1.7.12    purrr_1.0.1       renv_1.0.0       </span></span>
<span><span class="co">##  [9] textshaping_0.3.6 jsonlite_1.8.7    glue_1.6.2        rprojroot_2.0.3  </span></span>
<span><span class="co">## [13] htmltools_0.5.5   ragg_1.2.5        sass_0.4.7        rmarkdown_2.23   </span></span>
<span><span class="co">## [17] evaluate_0.21     jquerylib_0.1.4   fastmap_1.1.1     yaml_2.3.7       </span></span>
<span><span class="co">## [21] lifecycle_1.0.3   memoise_2.0.1     stringr_1.5.0     compiler_4.3.1   </span></span>
<span><span class="co">## [25] fs_1.6.3          systemfonts_1.0.4 digest_0.6.33     R6_2.5.1         </span></span>
<span><span class="co">## [29] magrittr_2.0.3    bslib_0.5.0       tools_4.3.1       pkgdown_2.0.7    </span></span>
<span><span class="co">## [33] cachem_1.0.8      desc_1.4.2</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>C. Huang and P. Kuan. (2023). intCC: An efficient weighted
integrative consensus clustering of multimodal data. Submitted. A.
Cabassi and P. D. Kirk. (2020). Multiple kernel learning for integrative
consensus clustering of omic datasets. Bioinformatics 36, 4789.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Can Huang.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
