<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to weighted consensus clustering • weightedCC</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to weighted consensus clustering">
<meta property="og:description" content="weightedCC">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">weightedCC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/wcc-vignette.html">Introduction to weighted consensus clustering</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to weighted consensus
clustering</h1>
                        <h4 data-toc-skip class="author">Can Huang</h4>
            
            <h4 data-toc-skip class="date">2022-11-07</h4>
      
      
      <div class="hidden name"><code>wcc-vignette.Rmd</code></div>

    </div>

    
    
<p>The R package <strong>wcc</strong> (<strong>w</strong>eighted
<strong>c</strong>onsensus <strong>c</strong>lustering) introduces
weighted consensus clustering functions inspired by consensus clustering
methods.</p>
<p>The main function in this package is
<code>WeightedConsensusCluster</code>. Users input a list of datasets,
clusteing methods, the number of clutsers for separate datasets and
global, criterions and so on. Then consensus clustering will be applied
to each dataset to derive consensus matrix. Depends on one layer or
two-layer, consensus matrix will be weighted and combined for each
dataset and final clustering. Finally user could choose pam or
hierarchical clustering method to derive the clustering results. Some
useful functions are also included in this package:</p>
<ul>
<li><p><code>criterion</code>. This function takes a list of consensus
matrix, a list of corresponding clustering label results and a vector of
corresponding number of clusters. It could use Silhouette, widestGap,
dunns and dunn2s index as criterion to choose the best number of
clusters.</p></li>
<li><p><code>weightcal</code>. This function takes a list of consensus
matrix and clustering label results. Then weights are calculated based
on ratio of in-cluster proportion to out-of-cluster proportion using the
cluster estimated by the algorithm itself. It could help to estimate
weights for different methods of each methods or weights for consensus
matrix of each dataset.</p></li>
</ul>
<p>The other function needed for this is <code>consensusCluster</code>.
This function can be found in the R package <code>coca</code> and is
used to perform consensus clustering on one dataset and obtain a
co-clustering matrix (Monti et al. 2003). We made some changes to this
function to allow users to define more distance metric and sample
percentage for features.</p>
<div class="section level2">
<h2 id="how-wcc-works">How wcc works<a class="anchor" aria-label="anchor" href="#how-wcc-works"></a>
</h2>
<p>First, we generate four different type datasets with the same
clustering structure (3 clusters of equal size) and different levels of
noise.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n1</span><span class="op">=</span><span class="fl">20</span></span>
<span><span class="va">n2</span><span class="op">=</span><span class="fl">20</span></span>
<span><span class="va">n3</span><span class="op">=</span><span class="fl">20</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="va">n1</span><span class="op">+</span><span class="va">n2</span><span class="op">+</span><span class="va">n3</span></span>
<span><span class="va">p</span><span class="op">=</span><span class="fl">30</span></span>
<span><span class="va">p1</span> <span class="op">=</span><span class="fl">5</span></span>
<span><span class="va">p2</span> <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="va">p3</span> <span class="op">=</span> <span class="fl">5</span></span>
<span></span>
<span><span class="va">true.class</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">n1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>,<span class="va">n2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>,<span class="va">n3</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co">################# normal distribution ####################</span></span>
<span>  <span class="va">c1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n1</span><span class="op">*</span><span class="va">p1</span>,mean<span class="op">=</span><span class="fl">2.2</span>,sd<span class="op">=</span><span class="fl">1.7</span><span class="op">)</span>, ncol<span class="op">=</span><span class="va">p1</span>,nrow<span class="op">=</span><span class="va">n1</span><span class="op">)</span></span>
<span>  <span class="va">c2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n2</span><span class="op">*</span><span class="va">p2</span>,mean<span class="op">=</span><span class="fl">1.6</span>, sd<span class="op">=</span><span class="fl">1.7</span><span class="op">)</span>, ncol<span class="op">=</span><span class="va">p2</span>,nrow<span class="op">=</span><span class="va">n2</span><span class="op">)</span></span>
<span>  <span class="va">c3</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n3</span><span class="op">*</span><span class="va">p3</span>,mean<span class="op">=</span><span class="fl">1</span>, sd<span class="op">=</span><span class="fl">1.7</span><span class="op">)</span>, ncol<span class="op">=</span><span class="va">p3</span>,nrow<span class="op">=</span><span class="va">n3</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">normData</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span>, mean<span class="op">=</span><span class="fl">0</span>, sd<span class="op">=</span><span class="fl">1.7</span><span class="op">)</span>,nrow<span class="op">=</span><span class="va">n</span>, ncol<span class="op">=</span><span class="va">p</span><span class="op">)</span></span>
<span>  <span class="va">normData</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n1</span>,<span class="fl">1</span><span class="op">:</span><span class="va">p1</span><span class="op">]</span><span class="op">=</span> <span class="va">c1</span></span>
<span>  <span class="va">normData</span><span class="op">[</span><span class="op">(</span><span class="va">n1</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">n1</span><span class="op">+</span><span class="va">n2</span><span class="op">)</span>,<span class="op">(</span><span class="va">p1</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">p1</span><span class="op">+</span><span class="va">p2</span><span class="op">)</span><span class="op">]</span><span class="op">=</span> <span class="va">c2</span></span>
<span>  <span class="va">normData</span><span class="op">[</span><span class="op">(</span><span class="va">n1</span><span class="op">+</span><span class="va">n2</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>,<span class="op">(</span><span class="va">p1</span><span class="op">+</span><span class="va">p2</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">p1</span><span class="op">+</span><span class="va">p2</span><span class="op">+</span><span class="va">p3</span><span class="op">)</span><span class="op">]</span><span class="op">=</span> <span class="va">c3</span></span>
<span>  </span>
<span>  <span class="va">noiseData</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span>, mean<span class="op">=</span><span class="fl">0</span>, sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,nrow<span class="op">=</span><span class="va">n</span>, ncol<span class="op">=</span><span class="va">p</span><span class="op">)</span></span>
<span>  <span class="co">######## binomial data #########################</span></span>
<span>  <span class="va">c1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n1</span><span class="op">*</span><span class="va">p1</span>,size<span class="op">=</span><span class="fl">1</span>, prob<span class="op">=</span><span class="fl">0.54</span><span class="op">)</span>, ncol<span class="op">=</span><span class="va">p1</span>,nrow<span class="op">=</span><span class="va">n1</span><span class="op">)</span></span>
<span>  <span class="va">c2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n2</span><span class="op">*</span><span class="va">p2</span>,size<span class="op">=</span><span class="fl">1</span>, prob<span class="op">=</span><span class="fl">0.42</span><span class="op">)</span>, ncol<span class="op">=</span><span class="va">p2</span>,nrow<span class="op">=</span><span class="va">n2</span><span class="op">)</span></span>
<span>  <span class="va">c3</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n3</span><span class="op">*</span><span class="va">p3</span>,size<span class="op">=</span><span class="fl">1</span>, prob<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span>, ncol<span class="op">=</span><span class="va">p3</span>,nrow<span class="op">=</span><span class="va">n3</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">binomData</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span>, size<span class="op">=</span><span class="fl">1</span>, prob<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span>,nrow<span class="op">=</span><span class="va">n</span>, ncol<span class="op">=</span><span class="va">p</span><span class="op">)</span></span>
<span>  <span class="va">binomData</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n1</span>,<span class="fl">1</span><span class="op">:</span><span class="va">p1</span><span class="op">]</span><span class="op">=</span> <span class="va">c1</span></span>
<span>  <span class="va">binomData</span><span class="op">[</span><span class="op">(</span><span class="va">n1</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">n1</span><span class="op">+</span><span class="va">n2</span><span class="op">)</span>,<span class="op">(</span><span class="va">p1</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">p1</span><span class="op">+</span><span class="va">p2</span><span class="op">)</span><span class="op">]</span><span class="op">=</span> <span class="va">c2</span></span>
<span>  <span class="va">binomData</span><span class="op">[</span><span class="op">(</span><span class="va">n1</span><span class="op">+</span><span class="va">n2</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>,<span class="op">(</span><span class="va">p1</span><span class="op">+</span><span class="va">p2</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">p1</span><span class="op">+</span><span class="va">p2</span><span class="op">+</span><span class="va">p3</span><span class="op">)</span><span class="op">]</span><span class="op">=</span> <span class="va">c3</span></span>
<span>  </span>
<span>  <span class="co">######### poisson data ############################</span></span>
<span>  <span class="va">c1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">n1</span><span class="op">*</span><span class="va">p1</span>,lambda<span class="op">=</span><span class="fl">1.9</span><span class="op">)</span>, ncol<span class="op">=</span><span class="va">p1</span>,nrow<span class="op">=</span><span class="va">n1</span><span class="op">)</span></span>
<span>  <span class="va">c2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">n2</span><span class="op">*</span><span class="va">p2</span>,lambda<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span>, ncol<span class="op">=</span><span class="va">p2</span>,nrow<span class="op">=</span><span class="va">n2</span><span class="op">)</span></span>
<span>  <span class="va">c3</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">n3</span><span class="op">*</span><span class="va">p3</span>,lambda<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, ncol<span class="op">=</span><span class="va">p3</span>,nrow<span class="op">=</span><span class="va">n3</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">poisData</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span>, lambda<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span>,nrow<span class="op">=</span><span class="va">n</span>, ncol<span class="op">=</span><span class="va">p</span><span class="op">)</span></span>
<span>  <span class="va">poisData</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n1</span>,<span class="fl">1</span><span class="op">:</span><span class="va">p1</span><span class="op">]</span><span class="op">=</span> <span class="va">c1</span></span>
<span>  <span class="va">poisData</span><span class="op">[</span><span class="op">(</span><span class="va">n1</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">n1</span><span class="op">+</span><span class="va">n2</span><span class="op">)</span>,<span class="op">(</span><span class="va">p1</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">p1</span><span class="op">+</span><span class="va">p2</span><span class="op">)</span><span class="op">]</span><span class="op">=</span> <span class="va">c2</span></span>
<span>  <span class="va">poisData</span><span class="op">[</span><span class="op">(</span><span class="va">n1</span><span class="op">+</span><span class="va">n2</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>,<span class="op">(</span><span class="va">p1</span><span class="op">+</span><span class="va">p2</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">p1</span><span class="op">+</span><span class="va">p2</span><span class="op">+</span><span class="va">p3</span><span class="op">)</span><span class="op">]</span><span class="op">=</span> <span class="va">c3</span></span>
<span></span>
<span>  <span class="co">################## multinomial distribution ##############</span></span>
<span>  <span class="va">c1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,size<span class="op">=</span><span class="va">n1</span><span class="op">*</span><span class="va">p1</span>, replace<span class="op">=</span><span class="cn">TRUE</span>, prob<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>,<span class="fl">0.15</span>,<span class="fl">0.05</span><span class="op">)</span><span class="op">)</span>, ncol<span class="op">=</span><span class="va">p1</span>,nrow<span class="op">=</span><span class="va">n1</span><span class="op">)</span></span>
<span>  <span class="va">c2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,size<span class="op">=</span><span class="va">n2</span><span class="op">*</span><span class="va">p2</span>, replace<span class="op">=</span><span class="cn">TRUE</span>, prob<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>,<span class="fl">0.4</span>,<span class="fl">0.3</span><span class="op">)</span><span class="op">)</span>, ncol<span class="op">=</span><span class="va">p2</span>,nrow<span class="op">=</span><span class="va">n2</span><span class="op">)</span></span>
<span>  <span class="va">c3</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,size<span class="op">=</span><span class="va">n3</span><span class="op">*</span><span class="va">p3</span>, replace<span class="op">=</span><span class="cn">TRUE</span>, prob<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>,<span class="fl">0.15</span>,<span class="fl">0.8</span><span class="op">)</span><span class="op">)</span>, ncol<span class="op">=</span><span class="va">p3</span>,nrow<span class="op">=</span><span class="va">n3</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">multData</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,size<span class="op">=</span><span class="va">n</span><span class="op">*</span><span class="va">p</span>, replace<span class="op">=</span><span class="cn">TRUE</span>, prob<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.33</span>,<span class="fl">0.33</span>,<span class="fl">0.33</span><span class="op">)</span><span class="op">)</span>,nrow<span class="op">=</span><span class="va">n</span>, ncol<span class="op">=</span><span class="va">p</span><span class="op">)</span></span>
<span>  <span class="va">multData</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n1</span>,<span class="fl">1</span><span class="op">:</span><span class="va">p1</span><span class="op">]</span><span class="op">=</span> <span class="va">c1</span></span>
<span>  <span class="va">multData</span><span class="op">[</span><span class="op">(</span><span class="va">n1</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">n1</span><span class="op">+</span><span class="va">n2</span><span class="op">)</span>,<span class="op">(</span><span class="va">p1</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">p1</span><span class="op">+</span><span class="va">p2</span><span class="op">)</span><span class="op">]</span><span class="op">=</span> <span class="va">c2</span></span>
<span>  <span class="va">multData</span><span class="op">[</span><span class="op">(</span><span class="va">n1</span><span class="op">+</span><span class="va">n2</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>,<span class="op">(</span><span class="va">p1</span><span class="op">+</span><span class="va">p2</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">p1</span><span class="op">+</span><span class="va">p2</span><span class="op">+</span><span class="va">p3</span><span class="op">)</span><span class="op">]</span><span class="op">=</span> <span class="va">c3</span></span>
<span>  </span>
<span>  </span>
<span>  <span class="co">#biID = seq(1,p,2)</span></span>
<span>  <span class="co">#multData[,biID] = binomData[,biID]</span></span>
<span>  </span>
<span>  <span class="co">### some variables only have one category; need to remove these variables</span></span>
<span>  <span class="va">ncat</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span>
<span>  <span class="va">len</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">binomData</span>,<span class="fl">2</span>,<span class="va">ncat</span><span class="op">)</span></span>
<span>  <span class="va">unicat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">len</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">unicat</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">binomData</span> <span class="op">=</span> <span class="va">binomData</span><span class="op">[</span>,<span class="op">-</span><span class="va">unicat</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span></code></pre></div>
<p>Now we can use the <code>consensusclustering</code> function to
compute a consensus matrix for each dataset.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">normRes</span><span class="op">=</span><span class="fu"><a href="../reference/consensuscluster.html">consensuscluster</a></span><span class="op">(</span><span class="va">normData</span>,K<span class="op">=</span><span class="fl">3</span>,B<span class="op">=</span><span class="fl">1000</span>,pItem <span class="op">=</span> <span class="fl">0.8</span>,pFeature <span class="op">=</span> <span class="fl">0.8</span> ,clMethod <span class="op">=</span><span class="st">"kmeans"</span>,finalclmethod<span class="op">=</span><span class="st">"pam"</span><span class="op">)</span></span>
<span>  <span class="va">binomRes</span><span class="op">=</span><span class="fu"><a href="../reference/consensuscluster.html">consensuscluster</a></span><span class="op">(</span><span class="va">binomData</span>,K<span class="op">=</span><span class="fl">3</span>,B<span class="op">=</span><span class="fl">1000</span>,pItem <span class="op">=</span> <span class="fl">0.8</span>,pFeature <span class="op">=</span> <span class="fl">0.8</span> ,clMethod <span class="op">=</span><span class="st">"kmeans"</span>,finalclmethod<span class="op">=</span><span class="st">"pam"</span><span class="op">)</span></span>
<span>  <span class="va">poisRes</span><span class="op">=</span><span class="fu"><a href="../reference/consensuscluster.html">consensuscluster</a></span><span class="op">(</span><span class="va">lopoisData</span>,K<span class="op">=</span><span class="fl">3</span>,B<span class="op">=</span><span class="fl">1000</span>,pItem <span class="op">=</span> <span class="fl">0.8</span>,pFeature <span class="op">=</span> <span class="fl">0.8</span> ,clMethod <span class="op">=</span><span class="st">"kmeans"</span>,finalclmethod<span class="op">=</span><span class="st">"pam"</span><span class="op">)</span></span>
<span>  <span class="va">multRes</span><span class="op">=</span><span class="fu"><a href="../reference/consensuscluster.html">consensuscluster</a></span><span class="op">(</span><span class="va">multData</span>,K<span class="op">=</span><span class="fl">3</span>,B<span class="op">=</span><span class="fl">1000</span>,pItem <span class="op">=</span> <span class="fl">0.8</span>,pFeature <span class="op">=</span> <span class="fl">0.8</span> ,clMethod <span class="op">=</span><span class="st">"kmeans"</span>,finalclmethod<span class="op">=</span><span class="st">"pam"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">normRes1</span><span class="op">=</span><span class="fu"><a href="../reference/consensuscluster.html">consensuscluster</a></span><span class="op">(</span><span class="va">normData</span>,K<span class="op">=</span><span class="fl">3</span>,B<span class="op">=</span><span class="fl">1000</span>,pItem <span class="op">=</span> <span class="fl">0.8</span>,pFeature <span class="op">=</span> <span class="fl">0.8</span> ,clMethod <span class="op">=</span><span class="st">"hclust"</span>,finalclmethod<span class="op">=</span><span class="st">"pam"</span><span class="op">)</span></span>
<span>  <span class="va">binomRes1</span><span class="op">=</span><span class="fu"><a href="../reference/consensuscluster.html">consensuscluster</a></span><span class="op">(</span><span class="va">binomData</span>,K<span class="op">=</span><span class="fl">3</span>,B<span class="op">=</span><span class="fl">1000</span>,pItem <span class="op">=</span> <span class="fl">0.8</span>,pFeature <span class="op">=</span> <span class="fl">0.8</span> ,clMethod <span class="op">=</span><span class="st">"hclust"</span>,dist <span class="op">=</span> <span class="st">"binary"</span>,finalclmethod<span class="op">=</span><span class="st">"pam"</span><span class="op">)</span></span>
<span>  <span class="va">poisRes1</span><span class="op">=</span><span class="fu"><a href="../reference/consensuscluster.html">consensuscluster</a></span><span class="op">(</span><span class="va">poisData</span>,K<span class="op">=</span><span class="fl">3</span>,B<span class="op">=</span><span class="fl">1000</span>,pItem <span class="op">=</span> <span class="fl">0.8</span>,pFeature <span class="op">=</span> <span class="fl">0.8</span> ,clMethod <span class="op">=</span><span class="st">"hclust"</span>,dist <span class="op">=</span> <span class="st">"jaccard"</span>,finalclmethod<span class="op">=</span><span class="st">"pam"</span><span class="op">)</span></span>
<span>  <span class="va">multRes1</span><span class="op">=</span><span class="fu"><a href="../reference/consensuscluster.html">consensuscluster</a></span><span class="op">(</span><span class="va">multData</span>,K<span class="op">=</span><span class="fl">3</span>,B<span class="op">=</span><span class="fl">1000</span>,pItem <span class="op">=</span> <span class="fl">0.8</span>,pFeature <span class="op">=</span> <span class="fl">0.8</span> ,clMethod <span class="op">=</span><span class="st">"hclust"</span>,dist <span class="op">=</span> <span class="st">"hamming"</span>,finalclmethod<span class="op">=</span><span class="st">"pam"</span><span class="op">)</span></span></code></pre></div>
<p>Then we could perform one layer weighted consensus clustering.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">res.all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">normRes</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">binomRes</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">poisRes</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">multRes</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">weights</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/weightcal.html">weightcal</a></span><span class="op">(</span><span class="va">res.all</span><span class="op">)</span></span>
<span>  <span class="va">wcm</span><span class="op">=</span><span class="va">weights</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">res.all</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span><span class="op">+</span><span class="va">weights</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">res.all</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span><span class="op">+</span></span>
<span>    <span class="va">weights</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">*</span><span class="va">res.all</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span><span class="op">+</span><span class="va">weights</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">*</span><span class="va">res.all</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span></span>
<span>  <span class="va">distances</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">wcm</span><span class="op">)</span></span>
<span>  <span class="va">weight_clusterLabels</span> <span class="op">&lt;-</span> <span class="fu">pam</span><span class="op">(</span><span class="va">distances</span>,<span class="fl">3</span>,diss <span class="op">=</span> <span class="cn">TRUE</span>,metric <span class="op">=</span> <span class="st">"euclidean"</span> <span class="op">)</span><span class="op">$</span><span class="va">clustering</span></span>
<span>  <span class="va">ari.weight</span><span class="op">&lt;-</span> <span class="fu">adjustedRandIndex</span><span class="op">(</span><span class="va">true.class</span>, <span class="va">weight_clusterLabels</span><span class="op">)</span></span></code></pre></div>
<p>Or we could perform two-layer weighted consensus clustering.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co">#norm</span></span>
<span>  <span class="va">res.norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">normRes</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">normRes1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">weight.norm</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/weightcal.html">weightcal</a></span><span class="op">(</span><span class="va">res.norm</span><span class="op">)</span></span>
<span>  <span class="va">wcm</span><span class="op">=</span><span class="va">weight.norm</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">res.norm</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span><span class="op">+</span><span class="va">weight.norm</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">res.norm</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span></span>
<span>  <span class="va">distances</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">wcm</span><span class="op">)</span></span>
<span>  <span class="va">weight_clusterLabels</span> <span class="op">&lt;-</span><span class="fu">pam</span><span class="op">(</span><span class="va">distances</span>,<span class="fl">3</span>,diss <span class="op">=</span> <span class="cn">TRUE</span>,metric <span class="op">=</span> <span class="st">"euclidean"</span> <span class="op">)</span><span class="op">$</span><span class="va">clustering</span></span>
<span>  <span class="va">weightnormRes</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>consensusMatrix<span class="op">=</span><span class="va">wcm</span>,class<span class="op">=</span><span class="va">weight_clusterLabels</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">#binom</span></span>
<span>  <span class="va">res.binom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">binomRes</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">binomRes1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">weight.binom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/weightcal.html">weightcal</a></span><span class="op">(</span><span class="va">res.binom</span><span class="op">)</span></span>
<span>  <span class="va">wcm</span><span class="op">=</span><span class="va">weight.binom</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">res.binom</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span><span class="op">+</span><span class="va">weight.binom</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">res.binom</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span></span>
<span>  <span class="va">distances</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">wcm</span><span class="op">)</span></span>
<span>  <span class="va">weight_clusterLabels</span> <span class="op">&lt;-</span> <span class="fu">pam</span><span class="op">(</span><span class="va">distances</span>,<span class="fl">3</span>,diss <span class="op">=</span> <span class="cn">TRUE</span>,metric <span class="op">=</span> <span class="st">"euclidean"</span> <span class="op">)</span><span class="op">$</span><span class="va">clustering</span></span>
<span>  <span class="va">weightbinomRes</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>consensusMatrix<span class="op">=</span><span class="va">wcm</span>,class<span class="op">=</span><span class="va">weight_clusterLabels</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">#poisson</span></span>
<span>  <span class="va">res.pois</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">poisRes</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">poisRes1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">weight.pois</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/weightcal.html">weightcal</a></span><span class="op">(</span><span class="va">res.pois</span><span class="op">)</span></span>
<span>  <span class="va">wcm</span><span class="op">=</span><span class="va">weight.pois</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">res.pois</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span><span class="op">+</span><span class="va">weight.pois</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">res.pois</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span></span>
<span>  <span class="va">distances</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">wcm</span><span class="op">)</span></span>
<span>  <span class="va">weight_clusterLabels</span> <span class="op">&lt;-</span><span class="fu">pam</span><span class="op">(</span><span class="va">distances</span>,<span class="fl">3</span>,diss <span class="op">=</span> <span class="cn">TRUE</span>,metric <span class="op">=</span> <span class="st">"euclidean"</span> <span class="op">)</span><span class="op">$</span><span class="va">clustering</span></span>
<span>  <span class="va">weightpoisRes</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>consensusMatrix<span class="op">=</span><span class="va">wcm</span>,class<span class="op">=</span><span class="va">weight_clusterLabels</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">#mult</span></span>
<span>  <span class="va">res.mult</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">multRes</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">multRes1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">weight.mult</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/weightcal.html">weightcal</a></span><span class="op">(</span><span class="va">res.mult</span><span class="op">)</span></span>
<span>  <span class="va">wcm</span><span class="op">=</span><span class="va">weight.mult</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">res.mult</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span><span class="op">+</span><span class="va">weight.mult</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">res.mult</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span></span>
<span>  <span class="va">distances</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">wcm</span><span class="op">)</span></span>
<span>  <span class="va">weight_clusterLabels</span> <span class="op">&lt;-</span> <span class="fu">pam</span><span class="op">(</span><span class="va">distances</span>,<span class="fl">3</span>,diss <span class="op">=</span> <span class="cn">TRUE</span>,metric <span class="op">=</span> <span class="st">"euclidean"</span> <span class="op">)</span><span class="op">$</span><span class="va">clustering</span></span>
<span>  <span class="va">weightmultRes</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>consensusMatrix<span class="op">=</span><span class="va">wcm</span>,class<span class="op">=</span><span class="va">weight_clusterLabels</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">#2 layer wcm</span></span>
<span>  <span class="va">res.wcm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">weightnormRes</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">weightbinomRes</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">weightpoisRes</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">weightmultRes</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">weight.wcm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/weightcal.html">weightcal</a></span><span class="op">(</span><span class="va">res.wcm</span><span class="op">)</span></span>
<span>  <span class="va">wcm</span><span class="op">=</span><span class="va">weight.wcm</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">res.wcm</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span><span class="op">+</span><span class="va">weight.wcm</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">res.wcm</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span><span class="op">+</span></span>
<span>    <span class="va">weight.wcm</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">*</span><span class="va">res.wcm</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span><span class="op">+</span><span class="va">weight.wcm</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">*</span><span class="va">res.wcm</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">consensusMatrix</span></span>
<span>  <span class="va">distances</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">wcm</span><span class="op">)</span></span>
<span>  <span class="va">weight_clusterLabels</span> <span class="op">&lt;-</span> <span class="fu">pam</span><span class="op">(</span><span class="va">distances</span>,<span class="fl">3</span>,diss <span class="op">=</span> <span class="cn">TRUE</span>,metric <span class="op">=</span> <span class="st">"euclidean"</span> <span class="op">)</span><span class="op">$</span><span class="va">clustering</span></span>
<span>  <span class="va">end.time3</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">ari.wcm</span> <span class="op">&lt;-</span> <span class="fu">adjustedRandIndex</span><span class="op">(</span><span class="va">true.class</span>, <span class="va">weight_clusterLabels</span><span class="op">)</span></span></code></pre></div>
<p>The same can be done simply using the function
<code>WeightedConsensusCluster</code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#one layer</span></span>
<span>  <span class="va">data_for_wcc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">data_for_wcc</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="va">normData</span></span>
<span>  <span class="va">data_for_wcc</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="va">binomData</span></span>
<span>  <span class="va">data_for_wcc</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="va">poisData</span></span>
<span>  <span class="va">data_for_wcc</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="va">multData</span></span>
<span>  <span class="va">wcc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/WeightedConsensusCluster.html">WeightedConsensusCluster</a></span><span class="op">(</span><span class="va">data_for_wcc</span>, method<span class="op">=</span><span class="st">"one layer"</span>, individualK <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>                                   globalK <span class="op">=</span> <span class="fl">3</span>, pFeature <span class="op">=</span> <span class="fl">0.8</span> ,ccClMethods <span class="op">=</span> <span class="st">"k-means"</span>,</span>
<span>                                    ccDistHCs <span class="op">=</span> <span class="st">"euclidean"</span>,hclustMethod <span class="op">=</span> <span class="st">"average"</span>,finalclmethod<span class="op">=</span><span class="st">"hclust"</span>,</span>
<span>                                    finalhclustMethod <span class="op">=</span> <span class="st">"average"</span>,Silhouette<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#two-layer</span></span>
<span>  <span class="va">data_for_wcc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">data_for_wcc</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="va">normData</span></span>
<span>  <span class="va">data_for_wcc</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="va">binomData</span></span>
<span>  <span class="va">data_for_wcc</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="va">lopoisData</span></span>
<span>  <span class="va">data_for_wcc</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="va">multData</span></span>
<span>  <span class="va">data_for_wcc</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="va">normData</span></span>
<span>  <span class="va">data_for_wcc</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="va">binomData</span></span>
<span>  <span class="va">data_for_wcc</span><span class="op">[[</span><span class="fl">7</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="va">poisData</span></span>
<span>  <span class="va">data_for_wcc</span><span class="op">[[</span><span class="fl">8</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="va">multData</span></span>
<span>  <span class="va">wcc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/WeightedConsensusCluster.html">WeightedConsensusCluster</a></span><span class="op">(</span><span class="va">data_for_wcc</span>, method<span class="op">=</span><span class="st">"one layer"</span>, individualK <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>                     globalK <span class="op">=</span> <span class="fl">3</span>, pFeature <span class="op">=</span> <span class="fl">0.8</span> ,ccClMethods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"kmeans"</span>,<span class="st">"kmeans"</span>,<span class="st">"kmeans"</span>,<span class="st">"kmeans"</span>,</span>
<span>                                                                  <span class="st">"hclust"</span>,<span class="st">"hclust"</span>,<span class="st">"hclust"</span>,<span class="st">"hclust"</span><span class="op">)</span>,</span>
<span>                     ccDistHCs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"euclidean"</span>,<span class="st">"euclidean"</span>,<span class="st">"euclidean"</span>,<span class="st">"euclidean"</span>,</span>
<span>                                   <span class="st">"euclidean"</span>,<span class="st">"binary"</span>,<span class="st">"jaccard"</span>,<span class="st">"hamming"</span><span class="op">)</span>,hclustMethod <span class="op">=</span> <span class="st">"average"</span>,finalclmethod<span class="op">=</span><span class="st">"hclust"</span>,</span>
<span>                                    finalhclustMethod <span class="op">=</span> <span class="st">"average"</span>,Silhouette<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Cabassi, A. and Kirk, P. D. W. (2019). Multiple kernel learning for
integrative consensus clustering of ’omic datasets. arXiv preprint.
arXiv:1904.07701.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Can Huang.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
